<!--修改员工信息-->
<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon"th:href="@{/images/01.jpg}" />
    <title>修改员工</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<style>
    /* 上传头像样式 */
    .imgtop{
        position: relative;
        top: -350px;
        left: 400px;
        width: 300px;
        height: auto;
        overflow: hidden;
        margin: 20px auto;
        color: #FFFFFF;

    }
    .in{
        position: absolute; 
        top: 0; 
        bottom: 0; 
        left: 0;
        right: 0; 
        opacity: 0;
    }
    .btnnn{
        width: 200px;
        height: 200px;

    }
    .spantext{
        font-size: 18px;
        color: #a09e9e;
        margin-top: 400px;
        margin-left: 20px;
    }
    .imgs{
        width: 150px; 
        height: 150px; 
        vertical-align: middle;
        border: 1px #eee;
        border-radius: 15px;
    }
    
</style>

<body>
    <!-- <div id="loading"><div id="loading-center"></div></div> -->
    <div class="wrapper" id="app">
        <div class="iq-sidebar">
            <div class="iq-sidebar-logo d-flex justify-content-between">
                <a href="/Index">
                    <!-- <img src="images/01.jpg" class="img-fluid" alt=""> -->
                    <span>湛小鲜后台管理</span>
                </a>

            </div>
            <div id="sidebar-scrollbar">
                <nav class="iq-sidebar-menu">
                    <ul class="iq-menu">

                        <li class="active">
                            <a href="/Index" class="iq-waves-effect"><i class="ri-home-8-fill"></i><span>内部成员首页</span></a>
                        </li>

                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i
                                    class="ri-settings-5-fill"></i><span>营销情况</span><i
                                    class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/Index">营销情况</a></li>
                            </ul>
                        </li>

                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i
                                    class="ri-user-settings-fill"></i><span>商品管理 </span><i
                                    class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/CommodityList">商品列表</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i class="ri-todo-fill"></i><span>订单管理
                        </span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/Orders">订单管理</a></li>
                            </ul>
                        </li>
                        <!--                    <li>-->
<!--                        <a href="javascript:void(0);" class="iq-waves-effect"><i-->
<!--                                class="ri-file-edit-fill"></i><span>快递管理</span><i-->
<!--                                class="ri-arrow-right-s-line iq-arrow-right"></i></a>-->
<!--                        <ul class="iq-submenu">-->
<!--                            <li><a href="/Address">快递地址管理</a></li>-->
<!--                            <li><a href="/Delivery">配送管理</a></li>-->
<!--                        </ul>-->
<!--                    </li>-->

                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i
                                    class="ri-alarm-warning-fill"></i><span>优惠券 </span><i
                                    class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/Coupons">优惠券</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i class="ri-bar-chart-2-fill"></i><span>员工管理
                        </span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/HireUser_management">员工管理 </a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i class="ri-barricade-fill"></i><span>内部成员管理
                        </span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/InternalUser_management">内部成员管理 </a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i class="ri-battery-2-charge-line"></i><span>顾客管理
                        </span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/User_management">顾客管理 </a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="iq-waves-effect"><i class="ri-pie-chart-2-fill"></i><span>个人中心
                        </span><i class="ri-arrow-right-s-line iq-arrow-right"></i></a>
                            <ul class="iq-submenu">
                                <li><a href="/Mine">查看个人信息</a></li>
                                <!--<li><a href="/Member_info">查看成员信息</a></li>-->
<!--                                <li><a href="/Modify_Info">修改个人信息</a></li>-->
                                <li><a href="/Boss_management">注册账号</a></li>
                            </ul>
                        </li>

                    </ul>
                </nav>
                <div class="p-3"></div>
            </div>
        </div>

        <!-- Page Content  -->
        <div id="content-page" class="content-page">
            <!-- TOP Nav Bar -->
            <div class="iq-top-navbar">
                <div class="iq-navbar-custom">

                    <nav class="navbar navbar-expand-lg navbar-light p-0">
                        <div class="iq-search-bar">
                            <form action="#" class="searchbox">
                                <!-- 按照编号查找 -->
                                <span class="text search-input keyword">欢迎来到湛小鲜后台管理系统</span>
                            </form>
                        </div>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav ml-auto navbar-list">
                                <!-- 全屏图标 -->
                                <li class="nav-item iq-full-screen">
                                    <a href="#" class="iq-waves-effect" id="btnFullscreen"><i
                                            class="ri-fullscreen-line"></i></a>
                                </li>
                            </ul>
                        </div>
                        <ul class="navbar-list">
                            <li>
                                <a href="#" class="search-toggle iq-waves-effect d-flex align-items-center">
                                   <img th:src="@{/images/01.jpg}" class="img-fluid rounded mr-3" alt="boss">
                                    <div class="caption">
                                        <h6 class="mb-0 line-height">湛小鲜</h6>
                                        <span class="font-size-12">管理员</span>
                                    </div>
                                </a>
                                <div class="iq-sub-dropdown iq-boss-dropdown">
                                    <div class="iq-card shadow-none m-0">
                                        <div class="iq-card-body p-0 ">
                                            <div class="bg-primary p-3">
                                                <h5 class="mb-0 text-white line-height">你好-湛小鲜</h5>
                                            </div>
                                            <a href="/Mine" class="iq-sub-card iq-bg-primary-hover">
                                                <div class="media align-items-center">
                                                    <div class="rounded iq-card-icon iq-bg-primary">
                                                        <i class="ri-file-boss-line"></i>
                                                    </div>
                                                    <div class="media-body ml-3">
                                                        <h6 class="mb-0 ">个人中心</h6>
                                                    </div>
                                                </div>
                                            </a>
                                        <!--                                            <a href="/Modify_Info" class="iq-sub-card iq-bg-primary-hover">-->
<!--                                                <div class="media align-items-center">-->
<!--                                                    <div class="rounded iq-card-icon iq-bg-primary">-->
<!--                                                        <i class="ri-profile-line"></i>-->
<!--                                                    </div>-->
<!--&lt;!&ndash;                                                    <div class="media-body ml-3">&ndash;&gt;-->
<!--&lt;!&ndash;                                                        <h6 class="mb-0 ">修改个人信息</h6>&ndash;&gt;-->
<!--&lt;!&ndash;                                                    </div>&ndash;&gt;-->
<!--                                                </div>-->
<!--                                            </a>-->
                                            <div class="d-inline-block w-100 text-center p-3">
                                                <a class="bg-primary iq-sign-btn" href="/signIn" role="button">退出登录<i
                                                        class="ri-login-box-line ml-2"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </nav>

                </div>
            </div>
            <!-- TOP Nav Bar END -->
            <div class="content-wrapper">
                <div class="content-header ">
                    <div class="content-header-left mb-2 clearfix">
                        <h3 class="content-header-title mb-0 pull-left">修改员工信息</h3>
                        <ol class="breadcrumb pull-right">
                            <li><a href="/HireUser_management">员工管理</a></li>
                            <li class="active">修改员工信息</li>
                        </ol>
                    </div>
                </div>
                <div class="card">
                    <div class="card-content">
                        <div class="card-body">
                            <div class="funcbtn clearfix">
                                <div class="pull-left"><a class="btn btn-default" href="/HireUser_management"> 返回</a></div>
                            </div>
                            <div class="form1 form3">
                                <ul class="row">
                                    <li class="col-sm-10 col-xs-12"><span>员工编号：</span><input type="text" disabled
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_id"></li>
                                    <li class="col-sm-10 col-xs-12"><span>员工姓名：</span><input type="text"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_name"></li>
                                    <li class="col-sm-10 col-xs-12"><span>员工职位：</span><input type="text"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_identity"></li>
                                    <li class="col-sm-10 col-xs-12"><span>手机号：</span><input type="text" minlength="11" maxlength="11" placeholder="请输入11位手机号"  onkeyup="value=value.replace(/[^\d]/g,'')"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_phone"></li>
                                    <li class="col-sm-10 col-xs-12"><span>身份证：</span><input type="text" minlength="18" maxlength="18" placeholder="请输入18位身份证" oninput = "value=value.replace(/[\u4E00-\u9FA5]/g,'')"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_identitycard"></li>
                                    <li class="col-sm-10 col-xs-12"><span>收益：</span><input type="text" onkeyup="value=value.replace(/^\D*(\d*(?:\.\d{0,2})?).*$/g, '$1')"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_proportion"></li>
                                    <li class="col-sm-10 col-xs-12"><span>单数：</span><input type="number" min="0"
                                            class="form-control" style="width: 600px;"
                                            v-model="newHireUser.hire_user_tradednumber"></li>
<!--                                    <li class="col-sm-10 col-xs-12"><span>状态：</span><select class="form-control"-->
<!--                                            style="width: 600px;" v-model="newHireUser.hireUser_is_deleted">-->
<!--                                            <option>0</option>-->
<!--                                            <option>1</option>-->
<!--                                        </select></li>-->
                                    <li class="col-sm-10 col-xs-12"><input type="submit" class="btn btn-primary"
                                            value="确认修改" @click="updateNewHireUser"></li>
                                </ul>
                                <div class="imgtop">
                                    <!-- 只接受jpg，gif和png格式 -->
<!--                                    <input id="upload-input" class="in"-->
<!--                                           ref="picx" type="file" accept="image/gif, image/jpg, image/png" onchange="showImg(this)" />-->
                                    <!-- 自定义按钮效果 -->
                                    <div class="btnnn">
                                        <img id="upload" :src="newHireUser.hire_user_image" class="imgs"/>
                                        <br>
                                        <span class="spantext">用户头像</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/smooth-scrollbar.js}"></script>
    <script th:src="@{/js/custom.js}"></script>
    <script th:src="@{/js/echarts.min.js}"></script>
    <script th:src="@{/js/axios-0.18.0.js}"></script>
    <script th:src="@{/js/vue.js}"></script>
</body>
<script>
    // 上传头像
    function showImg(input) {
        var file = input.files[0];
        var reader = new FileReader()
        // 图片读取成功回调函数
        reader.onload = function (e) {
            document.getElementById('upload').src = e.target.result
        }
        reader.readAsDataURL(file)
    }

    // 获取对应id
    function getQueryString(hire_user_id) {
        var reg = new RegExp('(^|&)' + hire_user_id + '=([^&]*)(&|$)', 'i');
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(r[2]);
        }
    }
    var hire_user_id = getQueryString("hire_user_id");
    console.log(hire_user_id);



    new Vue({
        el: '#app',
        data: {
            hireUserList: [],
            newHireUser:[
            {
                hire_user_id: "",
                hire_user_name: "",
                hire_user_identity: "",
                hire_user_phone: "",
                hire_user_identitycard: "",
                hire_user_image: "",
                hire_user_proportion: 0.00,
                hire_user_tradednumber: 0,
                hire_user_is_deleted: 0
            }
            ],
            hireImgfile:"hireUserImg",
            msg:""
        },
        methods: {
            updateNewHireUser() {//修改员工信息
                if (confirm("您是否确认修改")) {
                    axios
                        .post('/hireUserController/updateHireUser', this.newHireUser).then(response => (
                            console.log(response.data),
                            window.location.href='HireUser_management'
                        ))
                        .catch(function (error) { // 请求失败处理
                            console.log(error);
                        });
                }

            },
            // 按编号查询
            query1() {
               var keyword = $(".keyword").val();
               if (keyword == null|| keyword == "") {
                  Field = "all"
               }
               axios({
                  method: 'get',
                  url: '/接口?keyword=' + keyword 
               }).then(res => {
                  console.log("查询成功");
                  console.log(res.data);
                  if (res.data == null) {
                     this.commodityList = [];
                  } else {
                     this.commodityList = res.data;
                  }
               }, err => {
                  console.log(err);
               })
            },
            submit(){
                var that =this;
                let fd =new FormData();
                fd.append("file",this.$refs.picx.files[0]);
                fd.append("hireImgfile",this.hireImgfile);
                let descJson = JSON.stringify(this.newHireUser);                           //对象数组转换为JSON
                let descBob  = new Blob([descJson], {                               //对象数组转换为Blob
                    type: 'application/json',
                });
                // console.log(this.newHireUser)
                fd.append("hireUser",descBob);
                console.log(this.$refs.picx.files[0]);
                axios({
                    url: "/PhotoUpload",
                    method: "post",
                    headers: {'Content-Type': 'multipart/form-data'},
                    data: fd
                }).then(function (reponse) {
                    console.log(reponse);
                    var data = reponse.data;
                    if (data.code == 200) {
                        that.msg=data.message;
                        // document.getElementById('uploadt').src = data.data;
                    } else {
                        that.msg=data.message;
                    }
                })
            },

        },
        mounted() {//查找对应的员工
            axios
                .get('/hireUserController/queryHireUserById?hire_user_id=' + hire_user_id)
                .then(response => (
                    console.log(response.data),
                    this.hireUserList = response.data,
                    console.log(this.hireUserList),
                    this.newHireUser = this.hireUserList
                ))
                .catch(function (error) { // 请求失败处理
                    // console.log(error);
                });

        }
    })

</script>

</html>